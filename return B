
With these changes, the code is now more robust, documented, and organized. If you need any further modifications or have additional requests, feel free to ask!